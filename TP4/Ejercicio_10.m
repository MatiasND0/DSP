clear;clc;close all;

Sec = [0 2.19064313376741 -0.240787309403764 0.626980168831352 -0.626980168831352 0.240787309403765 -2.19064313376741 -1.46957615897682e-15 2.19064313376741 -0.240787309403762 0.626980168831351 -0.626980168831352 0.240787309403764 -2.19064313376741 -2.93915231795365e-15 2.19064313376741 -0.240787309403764 0.626980168831351 -0.626980168831353 0.240787309403769 -2.19064313376742 -4.40872847693047e-15 2.19064313376741 -0.240787309403764 0.626980168831352 -0.626980168831353 0.240787309403764 -2.19064313376742 -5.87830463590730e-15 2.19064313376741 -0.240787309403764 0.626980168831352 -0.626980168831352 0.240787309403767 -2.19064313376742 -2.42453437283118e-16 2.19064313376740 -0.240787309403760 0.626980168831349 -0.626980168831353 0.240787309403773 -2.19064313376741 -8.81745695386094e-15 2.19064313376741 -0.240787309403764 0.626980168831351 -0.626980168831351 0.240787309403778 -2.19064313376741 -3.18160575523676e-15 2.19064313376740 -0.240787309403765 0.626980168831353 -0.626980168831353 0.240787309403773 -2.19064313376743 -1.17566092718146e-14 2.19064313376741 -0.240787309403770 0.626980168831348 -0.626980168831351 0.240787309403772 -2.19064313376742 8.09009664201159e-15 2.19064313376742 -0.240787309403760 0.626980168831353 -0.626980168831353 0.240787309403782 -2.19064313376741 4.92530846286408e-14 2.19064313376740 -0.240787309403746 0.626980168831354 -0.626980168831354 0.240787309403775 -2.19064313376743 1.22563716816589e-14 2.19064313376741 -0.240787309403747 0.626980168831346 -0.626980168831356 0.240787309403774 -2.19064313376743 -1.76349139077219e-14 2.19064313376739 -0.240787309403755 0.626980168831351 -0.626980168831351 0.240787309403772 -2.19064313376742 2.35280740789073e-14 2.19064313376742 -0.240787309403745 0.626980168831343 -0.626980168831353 0.240787309403765 -2.19064313376741 3.62693526351325e-14 2.19064313376740 -0.240787309403746];
t=0:.1:120;
Sec = sin(2*pi*3001*t)+sin(2*pi*1000*t)+sin(2*pi*2500*t);

fm = 7000;
M=41;
W=hanning(M);


%filtro pasa altos con fc=2500hz
fc1=fm/2;
wc1=2*pi*fc1/fm;
wm1=wc1/pi;

hd1=wm1*sinc(wm1*( (-(M-1)/2):(M-1)/2) );
h1=hd1.*W';

fc2=2500;
wc2=2*pi*fc2/fm;
wm2=wc2/pi;

hd2=wm2*sinc(wm2*( (-(M-1)/2):(M-1)/2)  );
W=hanning(M);
h2=hd2.*W';

h3=h1-h2;

%Filtro pasa bajo con fc=1khzfc2=2500;
fc4=1500;
wc4=2*pi*fc4/fm;
wm4=wc4/pi;

hd4=wm4*sinc(wm4*( (-(M-1)/2):(M-1)/2)  );
W=hanning(M);
h4=hd4.*W';

h5=h1-h3-h4
%b)
fvtool(h5,1);

%c)
figure
subplot(2,2,1)
plot(Sec)
espectro=fftshift(abs(fft(Sec)));
frec=linspace(-fm/2,fm/2,length(Sec));
subplot(2,2,3)
stem(frec,espectro)
s2=conv(Sec,h5);
subplot(2,2,2)
plot(s2)
espectro=fftshift(abs(fft(s2)));
frec=linspace(-fm/2,fm/2,length(s2));
subplot(2,2,4)
stem(frec,espectro)
